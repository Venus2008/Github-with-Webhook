<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Event Detail</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body class="bg-light">
    <div class="container mt-5">
        <h2 class="mb-4">ðŸ“„ Event Detail</h2>

        <div class="card shadow-sm">
            <div class="card-body">
                <h5 class="card-title">Event: {{ event.event_type }}</h5>
                <p><strong>Repository:</strong> {{ event.repo_name }}</p>
                <p><strong>Received At:</strong> {{ event.received_at|date:"Y-m-d H:i:s" }}</p>

                <hr>

                <h6>Summary:</h6>
                    {% if summary %}
                        <ul class="list-group mb-3">
                            {% for key, value in summary.items %}
                            <li class="list-group-item">
                                <strong>{{ key }}:</strong>

                                {% if key == "Commits" %}
                                    <ul>
                                        {% for commit in value %}
                                        <li>
                                            <a href="{{ commit.url }}" target="_blank">
                                                {{ commit.message }}
                                            </a>
                                        </li>
                                        {% endfor %}
                                    </ul>

                                {% else %}
                                    {{ value }}
                                {% endif %}
                            </li>
                            {% endfor %}
                        </ul>
                    {% else %}
                        <p class="text-muted">No summary available for this event type.</p>
                    {% endif %}
                <hr>
                <h6>Payload (JSON):</h6>
                <pre id="json-output" class="bg-dark text-light p-3 rounded" style="max-height: 500px; overflow-y: auto;"></pre>
                {{ event.payload|json_script:"event-payload" }}

                <a href="{% url 'event_list' %}" class="btn btn-secondary mt-3">â¬… Back to Events</a>
            </div>
        </div>
    </div>

    <script>
        // Pretty print JSON payload
        const raw = JSON.parse(document.getElementById("event-payload").textContent);
        document.getElementById("json-output").textContent = JSON.stringify(raw, null, 2);
    </script>
</body>
</html>
